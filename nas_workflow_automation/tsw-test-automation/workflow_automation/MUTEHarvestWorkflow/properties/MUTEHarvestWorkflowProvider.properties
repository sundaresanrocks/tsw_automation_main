# Provider details
provider.classname=com.mcafee.tsw.agent.provider.HTTPFileWorkProvider
provider.targetDir=./MUTEHarvestWorkflow/download
provider.archiveDir=./MUTEHarvestWorkflow/archive
provider.errorDir=./MUTEHarvestWorkflow/error
provider.source_url=https://backend.mutegroup.org/api/geturls?start_id=<<<last_mute_id>>>&type=csv&counter=10000
provider.userAgent=Mozilla/5.0 (X11; Linux i686; rv:6.0) Gecko/20100101 Firefox/6.0
provider.userName=u2_support@securecomputing.com
provider.password=6Xs"2<<UD6A>TO'zjQBV
provider.enableHeartbeat=true
provider.heartrate=500

downloadUrl.allowAllCerts=true


# Worker - Preprocessor
worker.classname.1=com.mcafee.tsw.agent.worker.PreprocessorWorker
worker.threadcount.1=1

Preprocessor.count=1
Preprocessor.1.className=com.mcafee.tsw.preprocessor.RegexReplacePreprocessor
RegexReplacePreprocessor.match.1="
RegexReplacePreprocessor.replace.1=%22

RegexReplacePreprocessor.match.2=hxxp://
RegexReplacePreprocessor.replace.2=http://

RegexReplacePreprocessor.match.3=.*tinyurl\.com.*
RegexReplacePreprocessor.replace.3=

RegexReplacePreprocessor.match.4=.*ow\.ly.*
RegexReplacePreprocessor.replace.4=

RegexReplacePreprocessor.match.5=.*goo\.gl.*
RegexReplacePreprocessor.replace.5=


# Worker - Parse the file
worker.classname.2=com.mcafee.tsw.agent.worker.FileParserWorker
parser.classname=com.mcafee.tsw.parser.CsvFileParser
parser.skipParsedFiles=true

CsvParser.maxNumberOfColumns=8
CsvParser.fieldSeparator=\t
CsvParser.skipRowCount=1
CsvParser.column.1=mute_id
CsvParser.column.2=company
CsvParser.column.3=last_time
CsvParser.column.4=count
CsvParser.column.5=classification
CsvParser.column.6=whitelisted
CsvParser.column.7=malwarefamily
CsvParser.column.8=url

# Tracked facts
FactTracker.mute_id=last_mute_id,com.mcafee.tsw.agent.facttracker.NextToLastFactTracker
FactTracker.fileStore=/data/webcache/workflows/harvesters/MUTEHarvestWorkflow/facts.properties
maximumDecreaseValue=880001

# Consumer
consumer.classname=com.mcafee.tsw.agent.consumer.ActiveMQWorkflowConsumer
consumer.enableHeartbeat=true
consumer.heartrate=200

activemq_producer.connectionString=failover:(tcp://localhost:61616)
activemq_producer.username=admin
activemq_producer.password=admin
activemq_producer.queueName=mute_harvest_urls


# Info
verbose=true

agent.name=MUTEHarvestWorkflow
agent.getlock=false
