"""
Tests for MalwareDomainList Harvester
Different kinds of data formats are available in the same data source for improved coverage
"""

from harvesters.harvester import *
from harvesters.harvester_config import MalwareDomainListConfig


class MalwareDomainListFunc(SandboxedTest):

    @classmethod
    def setUpClass(cls):
        cls.hcon = MalwareDomainListConfig()
        cls.host = 'localhost'
        cls.user = 'toolguy'

    def test_resume_mode(self):
        """Run it only in Resume mode.
        Otherwise it starts collecting data from SampleDB
        and never ends in automation"""

        hcon = MalwareDomainListConfig()
        hcon.action_taken['Urls with Categories Appended']='20'

        hcon.rules_matched['(Salience=000000) Default Rule - Append ms']='20'

        hobj = Harvester(hcon,"partial")
        hobj.test_harvester_base('MalwareDomainList/mdl_01.txt')

    def a_test_non_resume(self):
        """Test by running it in non resume mode"""
        pass



